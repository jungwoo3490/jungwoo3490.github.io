{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/relay-migration/","result":{"data":{"markdownRemark":{"html":"<p>GraphQL을 공부하면서 실제 예제에 적용해보기 위해 서버 지인과 협업하여 당근마켓 중고거래 페이지 및 거래 품목 추가 페이지를 클론코딩해보았어요.</p>\n<p>GraphQL 사용 자체가 처음이었기 때문에, 처음에는 비교적 러닝커브가 낮은 Apollo Client를 사용해서 개발했어요.\n패키지 설치만 하면 따로 크게 추가 설정해줄 필요 없이 바로 사용이 가능해서 정말 편리했습니다.</p>\n<p>Apollo Client는 공식문서에 사용 방법이 아주 잘 나와있으니 참고하면 좋아요.</p>\n<h2>기존 Apollo Client 사용한 구현 과정</h2>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">client</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ApolloClient</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">uri:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;{서버 엔드포인트}&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">cache:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">InMemoryCache</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n<p>먼저 <code>ApolloClient</code> 인스턴스를 생성해주었어요. uri에는 서버 엔드포인트 주소를 지정하였고, cache에 <code>InMemoryCache()</code>를 사용하여 메모리 기반의 캐시를 생성해주었어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">ApolloProvider</span><span class=\"mtk1\"> </span><span class=\"mtk12\">client</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">client</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">RouterProvider</span><span class=\"mtk1\"> </span><span class=\"mtk12\">router</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">router</span><span class=\"mtk4\">}</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">ApolloProvider</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>애플리케이션 최상위 컴포넌트를 <code>ApolloProvider</code> 컴포넌트로 감싸고, <code>ApolloProvider</code> 컴포넌트에 위에서 생성한 Apollo Client 인스턴스인 <code>client</code>를 전달하여 Apollo Client의 기능을 전역으로 제공하도록 해주었어요.</p>\n<p>다음은 제품 목록을 가져오는 부분이애요. <code>Products</code>라는 GraphQL 쿼리를 정의하였고, <code>useQuery</code>를 사용하여 정의한 <code>GET_PRODUCTS</code> 쿼리를 실행하여 서버로부터 데이터를 받아왔어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GET_PRODUCTS</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">gql</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  query Products {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    products {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      id</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      title</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      imageUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      price</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      location</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      uploadDate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">loading</span><span class=\"mtk1\">, </span><span class=\"mtk12\">error</span><span class=\"mtk1\">, </span><span class=\"mtk12\">data</span><span class=\"mtk1\"> } = </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">(</span><span class=\"mtk12\">GET_PRODUCTS</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>다음은 제품을 추가하는 부분입니다. <code>addProduct</code>라는 GraphQL의 mutation을 정의하였고, <code>useMutation</code>에서 <code>refetchQueries</code> 옵션을 설정해주어 제품을 추가하고 나서 제품 목록 데이터를 새로 갱신하도록 해주었어요.</p>\n<p>폼을 제출하면 호출되는 <code>handleSubmit</code> 함수에서 <code>mutationFn</code>을 호출하여 mutation을 실행해 제품을 추가하도록 했어요. <code>variables</code>를 통해 mutation에 필요한 추가할 제품에 대한 데이터들을 전달해주었습니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ADD_PRODUCT</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">gql</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">mutation</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AddProduct</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">$title</span><span class=\"mtk1\">: </span><span class=\"mtk10\">String</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">$imageUrl</span><span class=\"mtk1\">: </span><span class=\"mtk10\">String</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">$price</span><span class=\"mtk1\">: </span><span class=\"mtk12\">Int</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">$location</span><span class=\"mtk1\">: </span><span class=\"mtk10\">String</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">addProduct</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">title</span><span class=\"mtk1\">: </span><span class=\"mtk12\">$title</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">imageUrl</span><span class=\"mtk1\">: </span><span class=\"mtk12\">$imageUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">price</span><span class=\"mtk1\">: </span><span class=\"mtk12\">$price</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">location</span><span class=\"mtk1\">: </span><span class=\"mtk12\">$location</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">id</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">title</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">imageUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">price</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">location</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">uploadDate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">mutationFn</span><span class=\"mtk1\">, { </span><span class=\"mtk12\">loading</span><span class=\"mtk1\">, </span><span class=\"mtk12\">data</span><span class=\"mtk1\">, </span><span class=\"mtk12\">error</span><span class=\"mtk1\"> }] = </span><span class=\"mtk11\">useMutation</span><span class=\"mtk1\">(</span><span class=\"mtk12\">ADD_PRODUCT</span><span class=\"mtk1\">,  {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">refetchQueries:</span><span class=\"mtk1\"> [{ </span><span class=\"mtk12\">query:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">GET_PRODUCTS</span><span class=\"mtk1\"> }],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">handleSubmit</span><span class=\"mtk1\"> = (</span><span class=\"mtk12\">e</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">mutationFn</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">variables:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">values</span><span class=\"mtk1\"> });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">navigate</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<p>Apollo를 사용해서 구현하고 나니, Relay도 경험해보고 싶은 욕심이 생겼어요. 그래서 Relay로 마이그레이션을 시도해보기로 했어요.</p>\n<p>그 과정에서 시행착오도 아주 많았고, 성공한 과정을 중점적으로 기록하려고 해요.</p>\n<h2>Relay로 마이그레이션</h2>\n<h3>1. 스키마 파일 생성</h3>\n<p><code>/src/schema/schema.graphql</code>에 다음과 같이 스키마를 추가해주었어요. 이 스키마는 서버에서 정의한 스키마와 동일한 구조로 세팅해주어야 해요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"graphql\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">type Product {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  id: ID!</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  title: String!</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  imageUrl: String</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  price: Float!</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  location: String!</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  uploadDate: String!</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">type Query {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  products: [Product]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">type Mutation {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  addProduct(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    title: String</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    imageUrl: String</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    price: Int</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    location: String</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    content: String</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  ): Product</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<h3>2. Relay 컴파일러 세팅</h3>\n<p>GraphQL 쿼리를 컴파일하기 위한 Relay 컴파일러를 설치해줍니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"sh\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">yarn add --dev relay-compiler</span></span></span></code></pre>\n<p>그리고, <code>package.json</code> script에 다음과 같이 세팅해줍니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"json\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&quot;scripts&quot;</span><span class=\"mtk1\">: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">&quot;relay&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;relay-compiler&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3>3. Relay 컴파일러 설정파일 추가</h3>\n<p>프로젝트 root 경로에 <code>relay.config.json</code> 파일을 만들고 다음과 같이 작성해주었어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"json\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">&quot;src&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;./src&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">&quot;schema&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;./src/schema/schema.graphql&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">&quot;language&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&quot;typescript&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>각 옵션값은 다음을 의미해요.</p>\n<p>• <strong>src</strong>: Relay 컴파일러가 소스 코드를 검색할 디렉토리에요. 프로젝트 내의 모든 소스 파일들이 src 폴더 내에 위치했으므로, ./src로 지정해주었어요.<br/>\n• <strong>schema</strong>: GraphQL 스키마 파일의 위치예요. 1에서 생성한 파일 경로를 지정하면 됩니다.<br/>\n• <strong>language</strong>: 사용 언어를 지정해요. TS로 개발했으므로 typescript로 지정하면 돼요.<br/></p>\n<p>이렇게 해두면 이후에 <code>yarn run relay</code> 명령을 통해 GraphQL 쿼리 파일을 컴파일할 수 있어요.</p>\n<h3>4. babel-plugin-relay 세팅</h3>\n<p>Relay는 GraphQL 쿼리를 실행 시에 사용할 수 있는 코드로 변환해야 하는데, 이 변환 작업을 <code>babel-plugin-relay</code>가 담당해요.</p>\n<p>다음 명령어로 Babel 플러그인과 GraphQL 라이브러리를 설치해줍니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"sh\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">yarn add --dev babel-plugin-relay graphql</span></span></span></code></pre>\n<p>그 후 <code>.babelrc</code> 파일에 다음과 같이 relay 플러그인을 추가해줍니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"json\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">&quot;plugins&quot;</span><span class=\"mtk1\">: [</span><span class=\"mtk8\">&quot;relay&quot;</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3>5.GraphQL 쿼리 파일 작성</h3>\n<p>서버로부터 데이터를 가져오기 위한 GraphQL 쿼리를 정의하는 파일을 생성해줍니다.</p>\n<p>제품 목록을 가져오는 query, 제품을 새로 등록하는 mutation 쿼리 파일을 각각 생성해주었어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// getProducts.ts</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 물품 목록을 가져오는 query</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">graphql</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;react-relay&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getProducts</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">graphql</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  query getProductsQuery {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    products {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      id</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      title</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      imageUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      price</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      location</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getProducts</span></span></span></code></pre>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// addProduct.ts</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 물품을 새로 등록하는 mutation</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">graphql</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;react-relay&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">addProduct</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">graphql</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  mutation addProductMutation(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    $title: String</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    $imageUrl: String</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    $price: Int</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    $location: String</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    addProduct(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      title: $title</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      imageUrl: $imageUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      price: $price</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      location: $location</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      id</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      title</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      imageUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      price</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      location</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">      uploadDate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk12\">addProduct</span></span></span></code></pre>\n<h3>6. GraphQL 쿼리 컴파일</h3>\n<p>쿼리 파일까지 잘 작성해주었다면, 다음 명령어를 통해 relay 컴파일러를 실행하여 GraphQL 쿼리를 컴파일하면 돼요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"sh\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">yarn run relay</span></span></span></code></pre>\n<p>성공적으로 컴파일되었다면, 다음과 같은 성공 로그가 뜨고,</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.22085889570552%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABWUlEQVR42jWPS2/TUBCF/SOCqHz9iu/1I347IbZx6gaoqornClFgASuWVdiRtuqKH/4xOOri05kZac7MsertC0Lfpbj6yfmPvwxfjgxf7xlu7hm/PdDf3LH+/Mj0/Rd/7p7z+7DgcHjG7e2C43HB9bXN2ZmP73t4noe1HQr6fmCadlRlQRwZIhMS6RAdhiSxIZFZEkcEvkYpD8fxRZ84GT1hdV3Jer0WNtR1TdO2VFU912maCiuSJCGOY0I54jgK13VmPM8VPeE4zqxWtdnx/t1bLvavGMcde9FpumDbdeR5QbBcorVBG0MYLsU8EvMTxuiZKPpfmxmr7c/59PED49Cze9lxdfmayzd7tpuWMl9J9CV1mVFkGUEQkWWNfF2xWlVyKBXN5zR5nlOWJVY/Tgx9R9tPJPWAF5UEaYMr6uh87pWWmcRuGiXL9kxV2dLb8pXCttUcWSnFPyISuM6HPDZaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt text\"\n        title=\"\"\n        src=\"/static/a7d171b3d421432ebe1695dc381dcb3e/a6d36/image-34.png\"\n        srcset=\"/static/a7d171b3d421432ebe1695dc381dcb3e/222b7/image-34.png 163w,\n/static/a7d171b3d421432ebe1695dc381dcb3e/ff46a/image-34.png 325w,\n/static/a7d171b3d421432ebe1695dc381dcb3e/a6d36/image-34.png 650w,\n/static/a7d171b3d421432ebe1695dc381dcb3e/e548f/image-34.png 975w,\n/static/a7d171b3d421432ebe1695dc381dcb3e/d56e1/image-34.png 1130w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>쿼리 파일이 위치한 경로에 <code>__generated__</code> 라는 폴더가 생성되면서 폴더 내부에 컴파일된 쿼리가 생성되게 돼요.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 610px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.558282208588956%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB2klEQVR42n2QWW/TUBBGDQheEKLlharQJqmXOEtJQ2O7juPlem26hAoqUEu6ICXiF/AEEhJ//DAuilQhwcPRnZl7Z+73jXamTJYf+0RhTB4F6I0tjOY2hpxms4Gtt4Tm/zFaWK0tvP0hWkOdU80usPIrtrI5evGZVnqJns9pqAueO+9Yc89YF1bn/XhN7teFZ/szzPQT2tNkyay4xSoWGOffCJe/GM6/4335ydvrH7wovvLo4OoP/jUP/4ofBzc8CW554N+wXS3ROp0uG07Gy+mCOFbk0xlRVjFJcuK8ojo6JSuPqI5n+GFCXh1TSi3OStJiit0bYNp9dKuL443RepZBa+DxOn7P2HNJlSLwx8RhJHsNCSeTO8a+L3WfLE2JJJ8EAXuDAZZpYhoG+s4OzmiE1rXbtEYRm9klKhEFhaiTYWmaoYQsLyjKiihOqA6nlNUhcaJIVIot7kyrTdvuYJgWjuuh9XffsHm0YBhmnJ6eUEpTIU2pDFJZjitqLWno9HfFXh+727ujI3FPelfU+TiYoNm2zatiTs9PycVO/XutpiaM4rtfawW1mvu0a6S+uquVut4BWr2DjegDe5OUaVkSil0ldlRtS3BloL6jy57Mf2KJ3fqNM3L4DeozJW4HGuSuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt text\"\n        title=\"\"\n        src=\"/static/cdcd7a5acdff93f3e0b64bdc5dce5e73/5aae9/image-35.png\"\n        srcset=\"/static/cdcd7a5acdff93f3e0b64bdc5dce5e73/222b7/image-35.png 163w,\n/static/cdcd7a5acdff93f3e0b64bdc5dce5e73/ff46a/image-35.png 325w,\n/static/cdcd7a5acdff93f3e0b64bdc5dce5e73/5aae9/image-35.png 610w\"\n        sizes=\"(max-width: 610px) 100vw, 610px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>7. Relay Environment 설정</h3>\n<p><code>src</code> 경로에 Relay Environment를 설정하기 위한 파일을 만들어주었어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">Environment</span><span class=\"mtk1\">, </span><span class=\"mtk12\">Network</span><span class=\"mtk1\">, </span><span class=\"mtk12\">RecordSource</span><span class=\"mtk1\">, </span><span class=\"mtk12\">Store</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;relay-runtime&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">source</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RecordSource</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">store</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Store</span><span class=\"mtk1\">(</span><span class=\"mtk12\">source</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">network</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">Network</span><span class=\"mtk1\">.</span><span class=\"mtk11\">create</span><span class=\"mtk1\">((</span><span class=\"mtk12\">operation</span><span class=\"mtk1\">, </span><span class=\"mtk12\">variables</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">graphqlEndpoint</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&quot;{서버 엔드포인트}&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">fetch</span><span class=\"mtk1\">(</span><span class=\"mtk12\">graphqlEndpoint</span><span class=\"mtk1\">, {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">method:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;POST&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">headers:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk8\">&quot;Content-Type&quot;</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;application/json&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">body:</span><span class=\"mtk1\"> </span><span class=\"mtk10\">JSON</span><span class=\"mtk1\">.</span><span class=\"mtk11\">stringify</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">query:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">operation</span><span class=\"mtk1\">.</span><span class=\"mtk12\">text</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">variables</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }).</span><span class=\"mtk11\">then</span><span class=\"mtk1\">(</span><span class=\"mtk12\">response</span><span class=\"mtk1\"> </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">json</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">handlerProvider</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">null</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">environment</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Environment</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">handlerProvider</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">network</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">store</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk12\">environment</span></span></span></code></pre>\n<p>각 부분은 다음과 같아요.</p>\n<h4>※ RecordSource &#x26; Store 설정</h4>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">source</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RecordSource</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">store</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Store</span><span class=\"mtk1\">(</span><span class=\"mtk12\">source</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p><code>RecordSource</code> 객체를 생성하여 Relay가 관리하는 데이터 소스를 설정하고, 이 소스를 바탕으로 <code>Store</code> 객체를 생성해요.<br/>\n<code>Store</code> 객체는 클라이언트 측의 데이터 캐시 역할을 합니다.</p>\n<h4>※ Network 설정</h4>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">network</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">Network</span><span class=\"mtk1\">.</span><span class=\"mtk11\">create</span><span class=\"mtk1\">((</span><span class=\"mtk12\">operation</span><span class=\"mtk1\">, </span><span class=\"mtk12\">variables</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">graphqlEndpoint</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&quot;{서버 엔드포인트}&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">fetch</span><span class=\"mtk1\">(</span><span class=\"mtk12\">graphqlEndpoint</span><span class=\"mtk1\">, {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">method:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;POST&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">headers:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk8\">&quot;Content-Type&quot;</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;application/json&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">body:</span><span class=\"mtk1\"> </span><span class=\"mtk10\">JSON</span><span class=\"mtk1\">.</span><span class=\"mtk11\">stringify</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">query:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">operation</span><span class=\"mtk1\">.</span><span class=\"mtk12\">text</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">variables</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }).</span><span class=\"mtk11\">then</span><span class=\"mtk1\">(</span><span class=\"mtk12\">response</span><span class=\"mtk1\"> </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">json</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n<p><code>graphqlEndpoint</code>를 서버의 엔드포인트로 지정해주면 돼요.<br/>\n지정한 엔드포인트에서 데이터를 fetch해서 json 형식으로 변환하게 됩니다.</p>\n<p>여기서 <code>method</code>가 <code>POST</code>로 고정된 이유는 GraphQL은 단일 엔드포인트에서 여러 종류의 요청을 처리해야 하기 때문에 일반적으로 <code>POST</code> 방식을 사용해서 query와 mutation을 처리하기 때문이에요.</p>\n<h4>※ Handler Provider 설정</h4>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">handlerProvider</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">null</span></span></span></code></pre>\n<p>Relay의 Handler를 제공할 때 사용하는 변수인데, 따로 사용이 필요하지 않아 <code>null</code>로 설정해주었어요.</p>\n<h4>※ Environment 설정</h4>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">environment</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Environment</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">handlerProvider</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">network</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">store</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n<p>Environment 클래스를 사용하여 Relay 환경을 설정했어요. 인자로 <code>handleProvider</code>, <code>network</code>, <code>store</code> 설정값을 주어 Relay가 GraphQL 요청을 처리하고 데이터를 캐시하는 데 필요한 모든 구성 요소를 포함시키게 돼요.</p>\n<h3>7. 전역으로 Relay 환경설정 제공</h3>\n<p>App.tsx에서 <code>RelayEnvironmentProvider</code> 컴포넌트를 통해 위에서 설정했던 환경설정을 전역으로 제공하도록 세팅해주었어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">App</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">router</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">createBrowserRouter</span><span class=\"mtk1\">([</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    { </span><span class=\"mtk12\">path:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;/&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">element:</span><span class=\"mtk1\"> </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">MainPage</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span><span class=\"mtk1\"> },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    { </span><span class=\"mtk12\">path:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;/add&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">element:</span><span class=\"mtk1\"> </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">AddPage</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span><span class=\"mtk1\"> },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">RelayEnvironmentProvider</span><span class=\"mtk1\"> </span><span class=\"mtk12\">environment</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">environment</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">RouterProvider</span><span class=\"mtk1\"> </span><span class=\"mtk12\">router</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">router</span><span class=\"mtk4\">}</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">RelayEnvironmentProvider</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3>8. GraphQL query 통신</h3>\n<p>GraphQL query를 통해 전체 상품 목록을 받아와봅시다.</p>\n<p>Relay에서 제공하는 <code>useLazyLoadQuery</code>를 사용해서 데이터를 받아올 수 있어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">useLazyLoadQuery</span><span class=\"mtk1\">(</span><span class=\"mtk12\">getProductsQuery</span><span class=\"mtk1\">, {})</span></span></span></code></pre>\n<p>첫 번째 인자로 실행할 GraphQL 쿼리를 정의한 객체를 전달하면 돼요.<br/>\n두 번째 인자로는 쿼리에 전달할 변수를 포함하는 객체를 전달하는데, 현재 쿼리에 변수가 없으므로 빈 객체를 전달했어요.</p>\n<p>실제로 데이터가 잘 받아와진 것을 확인할 수 있어요.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.852760736196316%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB2UlEQVR42mWS547bMBCE9TCxJFuNRRSLLLn3O6ccUt7/RSZDOkAC5MdgQUr8drZkqjcQUiF4j946FKsGy3yBZblEWZZJy4Iqi5eKv7EscrRCw44bGD+TY5CFzRUDD+M0IYSAqreoh4BV20EKga5rUWmDSlH9gNoG1IyVcWhopKlW6GrD2KCpK2RmcDDOoVY9eiUhph3E+R0yrLFmguhabM/o5gPE4Q7Jb2J3gTw+oK2FD3uM4QE3jtCGDq1bw/oRHcHW9OhoX53487TFEEYYSm6OhN0geZ+A+yuB96T++Qv68Q369oVJjwT6icCAztgEFHSi5x1GZ9mXgDa6IUTfv0LxkSAkAqP04wP67SNFRcWkmQvzC8jeGK0g5316OLBk7x1Ln1KJKkJ5L09v6aHYnQl/0OEP6ucrGZNkfn2AY1ltBLIHynoIPtLHGxT76Tn96LTbnljiLblNik4JVtfPUNE9lYBu3MFyKE0cDoGSMQHHiTAOhRKxh7Fn1yfk5fmn5Ms/QPbw/XuqJNN2jcFNaNWAtm0hlOZqjKikTmvTNg1Xpk+rUg/+Ja5RzfVK9zw3bkTj1+mcGQ7CcjUGLvg8T8llvviEMs+RUwUXuIgxarF4qcj/v+ObeP4NAJtJHc6cS1kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt text\"\n        title=\"\"\n        src=\"/static/29d537b25a64552742b5bca8ecc2f404/a6d36/image-36.png\"\n        srcset=\"/static/29d537b25a64552742b5bca8ecc2f404/222b7/image-36.png 163w,\n/static/29d537b25a64552742b5bca8ecc2f404/ff46a/image-36.png 325w,\n/static/29d537b25a64552742b5bca8ecc2f404/a6d36/image-36.png 650w,\n/static/29d537b25a64552742b5bca8ecc2f404/e548f/image-36.png 975w,\n/static/29d537b25a64552742b5bca8ecc2f404/3c492/image-36.png 1300w,\n/static/29d537b25a64552742b5bca8ecc2f404/133ae/image-36.png 1424w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3>9. GraphQL mutation 통신</h3>\n<p>먼저 <code>useMutation</code> hook을 사용하여 <code>addProduct</code> mutation을 실행하는 함수 <code>commitAddProduct</code>을 생성했어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">commitAddProduct</span><span class=\"mtk1\">] = </span><span class=\"mtk11\">useMutation</span><span class=\"mtk1\">(</span><span class=\"mtk12\">addProduct</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>그 후, 폼 제출시 실행할 <code>handleSubmit</code> 함수를 다음과 같이 정의해주었어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">handleSubmit</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">e</span><span class=\"mtk1\"> </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">commitAddProduct</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">variables:</span><span class=\"mtk1\"> { ...</span><span class=\"mtk12\">values</span><span class=\"mtk1\"> },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">onCompleted</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">navigate</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">onError</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\"> </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk10\">console</span><span class=\"mtk1\">.</span><span class=\"mtk11\">log</span><span class=\"mtk1\">(</span><span class=\"mtk12\">e</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><code>handleSubmit</code>은 <code>commitAddProduct</code> 함수를 호출하여 <code>addProduct</code> mutation을 실행해요.\n여기서, mutation에 전달할 변수가 존재하므로, <code>variables</code> 속성에 폼에서 수집한 <code>values</code> 객체 state의 프로퍼티들을 전달해주었어요.</p>\n<p><code>onCompleted</code> 콜백 함수는 mutation이 성공적으로 완료된 후에 호출돼요. 물품을 성공적으로 추가하면 홈 화면으로 이동하도록 해주었어요.</p>\n<p><code>onError</code> 콜백 함수는 mutation이 에러를 반환할 때 호출돼요. 별도의 에러페이지가 없어서 console에 에러를 로깅하도록 위와 같이 설정해주었는데, 실제론,ㄴ 별도의 에러페이지를 만들어 에러페이지로 리다이렉트하도록 예외처리를 해주는 게 좋을 것 같다는 생각을 했습니다.</p>\n<h3>캐시 데이터 대신 최신 데이터 받아오기</h3>\n<p>통신은 잘 됐는데, 다음과 같이 제품을 등록하고 홈 화면으로 이동하면 추가한 제품이 반영이 안 되어있고, 새로고침을 해야 반영되는 문제가 있었어요.</p>\n<video width=\"300\" controls>\n  <source src=\"https://github.com/jungwoo3490/jungwoo3490/assets/60962533/2221e194-7368-4189-b60a-c05052fb5720\" type=\"video/mp4\">\n</video>\n<br />\n<br />\n<p>Relay에서는 기본적으로 데이터를 클라이언트 측에 캐싱해요.</p>\n<p>캐시 데이터를 사용하기 때문에 위 화면과 같이 제품을 성공적으로 등록하고 홈 화면으로 이동해도 제품 목록에 바로 뜨지 않고 새로고침을 해야 반영되는 것이었어요.</p>\n<p>Apollo Client에서는 이 문제를 <code>refetchQueries</code>를 통해 mutation 후에 데이터를 갱신하도록 하여 해결했는데, Relay에서는 어떻게 하면 될까요?</p>\n<p>여러 방법이 있을 수 있지만, 나는 <code>useLazyLoadQuery</code>의 <code>fetchPolicy</code>를 <code>'network-only'</code>로 설정하여 항상 새로운 데이터를 네트워크에서 가져오도록 해서 해결했어요.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"ts\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">useLazyLoadQuery</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">getProductsQuery</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  {},</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  { </span><span class=\"mtk12\">fetchPolicy:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;network-only&quot;</span><span class=\"mtk1\"> },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>이렇게 설정해준 결과, 제품을 성공적으로 등록하고 홈 화면으로 이동하면 방금 추가한 제품이 목록에 바로 반영되는 것을 확인할 수 있었습니다.</p>\n<video width=\"300\" controls>\n  <source src=\"https://github.com/jungwoo3490/jungwoo3490/assets/60962533/e485e394-23e4-41ad-a33c-67eee9f36d79\" type=\"video/mp4\">\n</video>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk10 { color: #4EC9B0; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk17 { color: #808080; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"title":"Apollo to Relay 마이그레이션","desc":"Apollo Client를 이용했던 GraphQL 통신을 Relay로 마이그레이션해본 과정에 대한 글입니다.","thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKUlEQVR42mP4lM2AihgxRHAiDJ1ZjJ9yGD/lMqMgojRnMHzM5fiYyfoxgeFjIgwl43QOkp2ZDJ8Kuf4+vfT7+q6vMwO+zY/+Nj/y28LYr1O9PmUzE9KcxfCpgPPPg1O/L278Osn16wTHrxPsv3Sa/FhXCjQIZH8uC15nZzJ8zGb5mM70MZHxS6/V12leX/psfmysBDoBpDmHBc39GAGWw/wxheH7kuTvawq/dFt8neL2pcP4YzwwOIAuZwV5DbdmBpDmZKDmpO+r8r60G33ttfnab/91otOvixv+3D8B9BdIfw4jDs1ABPR8NuvX6T7fFid8WxjzbVHc11lBv2/s/fv0MjBECWkGux9oPyK2EoAmsn3K4yTkbDhCTydMoPSTTaRmzGSbg64ZAP9rYVxUSvy4AAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/201dc21b7f7593e524022e8cf298405e/654da/relay.jpg","srcSet":"/static/201dc21b7f7593e524022e8cf298405e/654da/relay.jpg 1400w","sizes":"1400px"},"sources":[{"srcSet":"/static/201dc21b7f7593e524022e8cf298405e/41667/relay.webp 1400w","type":"image/webp","sizes":"1400px"}]},"width":1400,"height":840}}},"date":"2024-07-02","category":"Dev"}}},"pageContext":{"slug":"/blog/relay-migration/"}},"staticQueryHashes":["1840460387"],"slicesMap":{}}